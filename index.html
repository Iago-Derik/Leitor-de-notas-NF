<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema Inteligente de Notas Fiscais</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/login.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Login Overlay -->
    <div id="loginOverlay">
        <div class="login-container">
            <h2>Bem-vindo ao SINF</h2>
            <p>Fa√ßa login para acessar suas notas</p>
            <form id="loginForm" class="login-form">
                <div class="form-group">
                    <label for="loginEmail">E-mail</label>
                    <input type="email" id="loginEmail" placeholder="seu@email.com" required>
                </div>
                <button type="submit" class="btn btn-primary btn-block">Entrar</button>
            </form>
            <div class="login-footer">
                <p>Sistema Inteligente de Notas Fiscais v1.0</p>
            </div>
        </div>
    </div>

    <div class="app-container hidden" id="appContainer">
        <!-- Sidebar Navigation -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <h2>SINF</h2>
                <p>Sistema Inteligente</p>
            </div>
            <div class="user-select-container" style="padding: 0 1.5rem; margin-bottom: 1rem;">
                <label style="color: rgba(255,255,255,0.7); font-size: 0.8rem; display: block; margin-bottom: 0.3rem;">Usu√°rio Logado</label>
                <div id="currentUserDisplay" style="color: white; font-weight: 500; padding: 0.3rem 0; border-bottom: 1px solid rgba(255,255,255,0.2);">
                    <!-- Email populated by JS -->
                </div>
                <button id="btnLogout" class="btn btn-sm btn-secondary" style="margin-top: 0.5rem; width: 100%; font-size: 0.8rem;">Sair</button>
            </div>
            <nav class="sidebar-nav">
                <ul>
                    <li><a href="#" class="nav-link active" data-target="upload-section">üìÑ Nova Nota</a></li>
                    <li><a href="#" class="nav-link" data-target="saved-invoices-section">üìÇ Notas Salvas</a></li>
                    <li><a href="#" class="nav-link" data-target="users-section">üë• Usu√°rios</a></li>
                    <li><a href="#" class="nav-link" data-target="customization-section">‚öôÔ∏è Personaliza√ß√£o</a></li>
                </ul>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="main-header">
                <h1>Sistema Inteligente de Notas Fiscais</h1>
            </header>

            <!-- Section: Upload & Form (Existing) -->
            <section id="upload-section" class="content-section">
                <!-- Upload Section -->
                <div class="upload-area">
                    <div class="drop-zone" id="drop-zone">
                        <span class="drop-zone__prompt">Arraste o arquivo aqui ou clique para selecionar</span>
                        <input type="file" name="file" class="drop-zone__input" id="fileInput" accept=".xml, .pdf" multiple>
                    </div>
                    <div id="loader" class="loader hidden">
                        <div class="spinner"></div>
                        <p id="loader-text">Processando nota fiscal...</p>
                    </div>
                </div>

                <!-- Invoice Details Form -->
                <div class="details-section hidden" id="details-section">
                    <h2>Detalhes da Nota</h2>
                    <form id="invoiceForm">
                        <div class="form-grid" id="dynamic-fields">
                            <!-- Fields will be populated by JS -->
                        </div>

                        <div class="form-group">
                            <label for="invoiceStatus">Status</label>
                            <select id="invoiceStatus" name="status" required>
                                <!-- Options populated by JS -->
                            </select>
                        </div>

                        <div class="form-actions">
                            <button type="submit" class="btn btn-primary">Salvar Nota</button>
                            <button type="button" class="btn btn-secondary" id="btnCancel">Cancelar</button>
                        </div>
                    </form>
                </div>
            </section>

            <!-- Section: Saved Invoices (New) -->
            <section id="saved-invoices-section" class="content-section hidden">
                <h2>Notas Salvas</h2>
                <div class="table-container">
                    <table id="invoicesTable" class="data-table">
                        <thead>
                            <tr>
                                <th>N√∫mero</th>
                                <th>CNPJ</th>
                                <th>Fornecedor</th>
                                <th>Valor</th>
                                <th>Emiss√£o</th>
                                <th>Centro de Custo</th>
                                <th>Status</th>
                                <th>A√ß√µes</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Rows populated by JS -->
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Section: Users (New) -->
            <section id="users-section" class="content-section hidden">
                <h2>Gerenciamento de Usu√°rios</h2>
                
                <div class="customization-group">
                    <h3>Adicionar Novo Usu√°rio</h3>
                    <form id="addUserForm" class="add-field-form">
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="newUserEmail">E-mail (Identificador)</label>
                                <input type="email" id="newUserEmail" placeholder="usuario@empresa.com" required>
                            </div>
                            <div class="form-group">
                                <label for="newUserWebhook">URL do Webhook (Power Automate)</label>
                                <input type="url" id="newUserWebhook" placeholder="https://..." required>
                            </div>
                            <div class="form-group">
                                <label for="newUserRole">Cargo</label>
                                <select id="newUserRole" required>
                                    <option value="member">Membro</option>
                                    <option value="admin">Administrador</option>
                                </select>
                            </div>
                        </div>
                        <button type="submit" class="btn btn-primary" style="margin-top: 10px;">Adicionar Usu√°rio</button>
                    </form>
                </div>

                <div class="customization-group">
                    <h3>Usu√°rios Cadastrados</h3>
                    <div class="table-container">
                        <table id="usersTable" class="data-table">
                            <thead>
                                <tr>
                                    <th>E-mail</th>
                                    <th>Cargo</th>
                                    <th>Webhook Configurado</th>
                                    <th>A√ß√µes</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Populated by JS -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <!-- Section: Customization (New) -->
            <section id="customization-section" class="content-section hidden">
                <h2>Personaliza√ß√£o</h2>
                
                <div class="customization-group">
                    <h3>Campos do Formul√°rio</h3>
                    <div id="fields-config-list" class="config-list">
                        <!-- Config items populated by JS -->
                    </div>
                </div>

                <div class="customization-group">
                    <h3>Adicionar Campo Personalizado</h3>
                    <form id="addCustomFieldForm" class="add-field-form">
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="newFieldLabel">Nome do Campo</label>
                                <input type="text" id="newFieldLabel" required>
                            </div>
                            <div class="form-group">
                                <label for="newFieldType">Tipo</label>
                                <select id="newFieldType" required>
                                    <option value="text">Texto</option>
                                    <option value="number">N√∫mero</option>
                                    <option value="date">Data</option>
                                    <option value="select">Lista de Op√ß√µes</option>
                                </select>
                            </div>                            <div class="form-group hidden" id="optionsFieldGroup">
                                <label for="newFieldOptions">Op√ß√µes (separadas por v√≠rgula)</label>
                                <input type="text" id="newFieldOptions" placeholder="Ex: Op√ß√£o 1, Op√ß√£o 2, Op√ß√£o 3">
                            </div>                        </div>
                        <button type="submit" class="btn btn-secondary">Adicionar Campo</button>
                    </form>
                </div>

                <div class="customization-group">
                    <h3>Centros de Custo</h3>
                    <div id="cost-centers-list" class="config-list">
                        <!-- Cost centers list -->
                    </div>
                    <form id="addCostCenterForm" class="add-field-form mt-2">
                         <div class="form-grid">
                            <div class="form-group">
                                <label for="newCostCenterCode">C√≥digo</label>
                                <input type="number" id="newCostCenterCode" required>
                            </div>
                            <div class="form-group">
                                <label for="newCostCenterDesc">Descri√ß√£o</label>
                                <input type="text" id="newCostCenterDesc" required>
                            </div>
                        </div>
                        <button type="submit" class="btn btn-secondary">Adicionar Centro de Custo</button>
                    </form>
                </div>
            </section>
        </main>
    </div>

    <!-- Scripts -->
    <script src="js/config.js"></script>
    <script src="js/storage.js"></script>
    <script src="js/services.js"></script>
    <script src="js/validation.js"></script>
    <script src="js/dom.js"></script>
    <script src="js/main.js"></script>
</body>
</html>
